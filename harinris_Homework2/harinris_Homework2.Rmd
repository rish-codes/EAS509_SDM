---
title: "harinris_Homework2"
author: "Harin Rishabh"
date: "2024-02-22"
output: html_document
---

# Chapter 1 - R Commands

Loading library
```{r}
library(TSA)
```

## Exhibit 1.1
```{r}
data(larain)
plot(larain,ylab='Inches',xlab='Year',type='o')
```

## Exhibit 1.2
```{r}
plot(y=larain,x=zlag(larain),ylab='Inches',xlab='Previous Year Inches')
```

## Exhibit 1.3
```{r}
data(color)
plot(color,ylab='Color Property',xlab='Batch',type='o')
```

## Exhibit 1.4
```{r}
plot(y=color,x=zlag(color),ylab='Color Property',
xlab='Prevous Batch Color Property')
```

## Exhibit 1.5
```{r}
data(hare)
plot(hare,ylab='Abundance',xlab='Year',type='o')
```

## Exhibit 1.6
```{r}
plot(y=hare,x=zlag(hare),ylab='Abundance',xlab='Previous Year Abundance')
```

## Exhibit 1.7
```{r}
data(tempdub)
plot(tempdub,ylab='Temperature',type='o')
```

## Exhibit 1.8
```{r}
data(oilfilters)
plot(oilfilters,type='o',ylab='Sales')
```

## Exhibit 1.9
```{r}
plot(oilfilters,type='l',ylab='Sales')
Month=c("J","A","S","O","N","D","J","F","M","A","M","J")
points(oilfilters,pch=Month)
```

## Alternatively, the exhibit can be reproduced by the following commands
```{r}
plot(oilfilters,type='l',ylab='Sales')
points(y=oilfilters,x=time(oilfilters),pch=as.vector(season(oilfilters)))
```



# Chapter 2 - R Commands

## Exhibit 2.1
rwalk contains a simulated random walk
```{r}
data(rwalk)
plot(rwalk,type='o',ylab='Random Walk')
```

R code for simulating a random walk with, say 60, independant standard normal errors
```{r}
n=60
set.seed(12345)
sim.random.walk=ts(cumsum(rnorm(n)),freq=1,start=1)
plot(sim.random.walk,type='o',ylab='Another Random Walk')
```


# Chapter 3 - R Commands

## Exhibit 3.1
time(rwalk) yields a time series of the time epoches when the random walk was sampled.
```{r}
data(rwalk)
model1=lm(rwalk~time(rwalk))
summary(model1)
```

## Exhibit 3.2
rwalk contains a simulated random walk
```{r}
plot(rwalk,type='o',ylab='y')
abline(model1) # add the fitted least squares line
```

## Exhibit 3.3
season(tempdub) creates a vector of the month index of the data as a factor
```{r}
data(tempdub)
month.=season(tempdub) # the period sign is included to make the printout from
# the commands two line below clearer; ditto below.
model2=lm(tempdub~month.-1) # -1 removes the intercept term 
summary(model2)
```

## Exhibit 3.4
```{r}
model3=lm(tempdub~month.) # intercept is automatically included so one month (Jan) is dropped
summary(model3)
```

## Exhibit 3.5
first creates the first pair of harmonic functions and then fit the model
```{r}
har.=harmonic(tempdub,1)
model4=lm(tempdub~har.)
summary(model4)
```

## Exhibit 3.6
```{r}
plot(ts(fitted(model4),freq=12,start=c(1964,1)),ylab='Temperature',type='l',
ylim=range(c(fitted(model4),tempdub))) # the ylim option ensures that the 
# y axis has a range that fits the raw data and the fitted values
points(tempdub)
```

## Exhibit 3.7
```{r}
data(rwalk)
model1=lm(rwalk~time(rwalk))
summary(model1)
```

## Exhibit 3.8
```{r}
plot(y=rstudent(model3),x=as.vector(time(tempdub)),xlab='Time',
ylab='Standardized Residuals',type='o')
```

## Exhibit 3.9
```{r}
plot(y=rstudent(model3),x=as.vector(time(tempdub)),xlab='Time',
ylab='Standardized Residuals',type='l')
points(y=rstudent(model3),x=as.vector(time(tempdub)),
pch=as.vector(season(tempdub)))
```

## Exhibit 3.10
```{r}
plot(y=rstudent(model3),x=as.vector(fitted(model3)),xlab='Fitted Trend Values',
ylab='Standardized Residuals',type="n")
points(y=rstudent(model3),x=as.vector(fitted(model3)),
pch=as.vector(season(tempdub)))
```

## Exhibit 3.11
```{r}
hist(rstudent(model3),xlab='Standardized Residuals',main='')
```

## Exhibit 3.12
```{r}
qqnorm(rstudent(model3),main='')
```

## Exhibit 3.13
```{r}
acf(rstudent(model3),main='')
```

## Exhibit 3.14
```{r}
plot(y=rstudent(model1),x=as.vector(time(rwalk)),ylab='Standardized Residuals',
xlab='Time',type='o')
```

## Exhibit 3.15
```{r}
plot(y=rstudent(model1),x=fitted(model1),ylab='Standardized Residuals',
xlab='Fitted Trend Values',type='p')
```

## Exhibit 3.16
```{r}
acf(rstudent(model1),main='')
```



# Exercise 1

**1.3**\
Answer - The plots are random.
```{r}
plot(as.ts(rnorm(48)))
plot(as.ts(rnorm(48)))
plot(as.ts(rnorm(48)))
plot(as.ts(rnorm(48)))
```

**1.4**\
Answer - Plots are random and non-normal.
```{r}
plot(as.ts(rchisq(48, 2)))
plot(as.ts(rchisq(48, 2)))
plot(as.ts(rchisq(48, 2)))
plot(as.ts(rchisq(48, 2)))
```

**1.5**\
Answer - Plots look to be random and non-normal.
```{r}
plot(as.ts(rt(48, 5)))
plot(as.ts(rt(48, 5)))
plot(as.ts(rt(48, 5)))
plot(as.ts(rt(48, 5)))
```